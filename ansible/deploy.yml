- name: Deploy Python script as a systemd service
  hosts: localhost
  become: yes
  tasks:
    - name: Create service directory
      file:
        path: /opt/my-python-service
        state: directory
        mode: "0755"

    - name: Copy Python script to server
      copy:
        src: ../i_am_alive.py
        dest: /opt/my-python-service/i_am_alive.py
        mode: "0755"

    - name: Copy service file to systemd
      copy:
        src: ../i_am_alive.service
        dest: /etc/systemd/system/i_am_alive.service
        mode: "0644"

    - name: Reload systemd
      command: systemctl daemon-reload

    - name: Enable the service
      systemd:
        name: i_am_alive.service
        enabled: yes
        state: started
